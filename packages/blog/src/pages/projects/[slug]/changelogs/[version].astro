---
import { getCollection, getEntry } from 'astro:content';
import MainLayout from '@/layouts/MainLayout/MainLayout.astro';
import type { Project } from '@/shared/project.helpers.ts';
import type { Changelog } from '@/shared/changelog.helpers.ts';
import {
  formatEntryPublishedAt,
  PublishedAtFormat,
} from '@/shared/collection.helpers.ts';

export async function getStaticPaths() {
  const changelogs = await getCollection('changelogs');

  return await Promise.all(
    changelogs.map(async (changelog) => {
      const project = await getEntry(changelog.data.project);
      const version = changelog.slug.split('__')[1];

      return {
        params: { slug: project.slug, version },
        props: { project, changelog },
      };
    }),
  );
}

interface Props {
  project: Project;
  changelog: Changelog;
}
---

<MainLayout> changelog </MainLayout>
